paths:
  /competitions/{competitionSeq}/fop/status/main/{status}:
    post:
      summary: FOP 조작 버튼 API (Main Status 변경)
      tags:
        - FOP
      parameters:
        - name: competitionSeq
          in: path
          required: true
          schema:
            type: integer
        - name: status
          in: path
          required: true
          description: FOP main status
          schema:
            type: string
            enum:
              - NONE
              - DRAW_POOMSAE
              - READY
              - FIRST_START
              - STOP
              - START
              - RESULT
              - NEXT_POOMSAE
              - SCORE
              - FINISH
              - REMATCH
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - competitionMatchPsSeq
              properties:
                competitionMatchPsSeq:
                  type: integer
                  description:
                    '매치 seq'
                  example: "1234"
      responses:
        '200':
          description: 성공
          content:
            application/json:
              schema:
                type: object
                required:
                properties:
                  success:
                    type: boolean
                    required: true
                    example: true
                  data:
                    type: object
                    required: true
                    properties:
                      clientEffectTypeList:
                        required: true
                        type: array
                        description: 프론트에서 띄워야 할 alert
                  error:
                    required: true
                    nullable: true
                    example: null
              examples:
                defaultResponse:
                  summary: Default Example
                  value:
                    {
                      "success": true,
                      "data": {
                        "clientEffectTypeList": [
                          "show-phaseProcessingModal"
                        ]
                      },
                      "error": null
                    }
                COMPETITION_MATCH_NOT_FOUND:
                  $ref: '../../openapi.yml/#/components/examples/COMPETITION_MATCH_NOT_FOUND'

        400:
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: '../../openapi.yml/#/components/responses/Error'
              examples:
                INVALID_TYPE_ERROR:
                  $ref: '../../openapi.yml#/components/examples/INVALID_TYPE_ERROR'
                WRONG_FOP_STATUS:
                  $ref: '../../openapi.yml#/components/examples/WRONG_FOP_STATUS'

        403:
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '../../openapi.yml/#/components/responses/Error'
              examples:
                IS_NOT_AUTHORIZED:
                  $ref: '../../openapi.yml/#/components/examples/IS_NOT_AUTHORIZED'

  /competitions/{competitionSeq}/fop/status/side/{status}/activate:
    post:
      summary: FOP 조작 버튼 API (activate Side Status)
      tags:
        - FOP
      parameters:
        - name: competitionSeq
          in: path
          required: true
          schema:
            type: integer
        - name: status
          in: path
          required: true
          description: FOP main status
          schema:
            type: string
            enum:
              - LOGO
              - SHOW_POOMSAE
              - INJURY
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - competitionMatchPsSeq
              properties:
                competitionMatchPsSeq:
                  type: integer
                  description:
                    '매치 seq'
                  example: "1234"
      responses:
        '200':
          description: 성공
          content:
            application/json:
              schema:
                type: object
                required:
                properties:
                  success:
                    type: boolean
                    required: true
                    example: true
                  data:
                    required: true
                    nullable: true
                    example: null
                  error:
                    required: true
                    nullable: true
                    example: null
              examples:
                defaultResponse:
                  summary: Default Example
                  value:
                    {
                      "success": true,
                      "data": null,
                      "error": null
                    }
                COMPETITION_MATCH_NOT_FOUND:
                  $ref: '../../openapi.yml/#/components/examples/COMPETITION_MATCH_NOT_FOUND'

        400:
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: '../../openapi.yml/#/components/responses/Error'
              examples:
                INVALID_TYPE_ERROR:
                  $ref: '../../openapi.yml#/components/examples/INVALID_TYPE_ERROR'
                WRONG_FOP_STATUS:
                  $ref: '../../openapi.yml#/components/examples/WRONG_FOP_STATUS'

        403:
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '../../openapi.yml/#/components/responses/Error'
              examples:
                IS_NOT_AUTHORIZED:
                  $ref: '../../openapi.yml/#/components/examples/IS_NOT_AUTHORIZED'

  /competitions/{competitionSeq}/fop/status/side/{status}/deactivate:
    post:
      summary: FOP 조작 버튼 API (deactivate Side Status)
      tags:
        - FOP
      parameters:
        - name: competitionSeq
          in: path
          required: true
          schema:
            type: integer
        - name: status
          in: path
          required: true
          description: FOP main status
          schema:
            type: string
            enum:
              - LOGO
              - SHOW_POOMSAE
              - INJURY
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - competitionMatchPsSeq
              properties:
                competitionMatchPsSeq:
                  type: integer
                  description:
                    '매치 seq'
                  example: "1234"
      responses:
        '200':
          description: 성공
          content:
            application/json:
              schema:
                type: object
                required:
                properties:
                  success:
                    type: boolean
                    required: true
                    example: true
                  data:
                    required: true
                    nullable: true
                    example: null
                  error:
                    required: true
                    nullable: true
                    example: null
              examples:
                defaultResponse:
                  summary: Default Example
                  value:
                    {
                      "success": true,
                      "data": null,
                      "error": null
                    }
                COMPETITION_MATCH_NOT_FOUND:
                  $ref: '../../openapi.yml/#/components/examples/COMPETITION_MATCH_NOT_FOUND'

        400:
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: '../../openapi.yml/#/components/responses/Error'
              examples:
                INVALID_TYPE_ERROR:
                  $ref: '../../openapi.yml#/components/examples/INVALID_TYPE_ERROR'
                WRONG_FOP_STATUS:
                  $ref: '../../openapi.yml#/components/examples/WRONG_FOP_STATUS'

        403:
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '../../openapi.yml/#/components/responses/Error'
              examples:
                IS_NOT_AUTHORIZED:
                  $ref: '../../openapi.yml/#/components/examples/IS_NOT_AUTHORIZED'

  /competitions/{competitionSeq}/fop/status/match/{competitionMatchPsSeq}:
    get:
      summary: match 마지막 FOP 상태 가져오기
      tags:
        - FOP
      parameters:
        - name: competitionSeq
          in: path
          required: true
          schema:
            type: integer
        - name: competitionMatchPsSeq
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: FOP 상태 변경 이벤트 데이터 조회 성공
          content:
            application/json:
              schema:
                type: object
                description: FOP(Floor of Play) 상태 변경 이벤트 페이로드
                required:
                  - location
                  - method
                  - data
                properties:
                  location:
                    type: string
                    description: 이벤트가 발생한 도메인/모듈 식별자
                    example: fop
                  method:
                    type: string
                    description: 이벤트 동작 식별자
                    example: change-status
                  data:
                    type: object
                    description: 상태 변경에 필요한 매치 및 품새 정보
                    required:
                      - matchInfo
                      - mainStatus
                      - data
                      - enableNextStatusTypes
                    properties:
                      matchInfo:
                        type: object
                        description: 매치 기본 정보
                        required:
                          - competitionMatchPsSeq
                          - matchNumber
                          - divisionCode
                          - divisionNameKo
                          - divisionNameEn
                          - departmentCode
                          - departmentNameKo
                          - departmentNameEn
                          - divisionCategoryCode
                          - divisionCategoryNameKo
                          - divisionCategoryNameEn
                          - matchStyleType
                          - phase
                        properties:
                          competitionMatchPsSeq:
                            type: integer
                            format: int64
                            description: 품새 매치 식별자(내부 시퀀스)
                            example: 20024
                          matchNumber:
                            type: integer
                            description: 운영 화면에 노출되는 매치 번호
                            example: 1001
                          divisionCode:
                            type: string
                            description: 디비전 코드
                            example: WT_RECOGNIZED_POOMSAE
                          divisionNameKo:
                            type: string
                            description: 디비전 한글명
                            example: WT 공인품새룰
                          divisionNameEn:
                            type: string
                            description: 디비전 영문명
                            example: WT Recognized Poomsae
                          departmentCode:
                            type: string
                            description: 부서/연령/그룹 코드
                            example: UNDER_30
                          departmentNameKo:
                            type: string
                            description: 부서/연령/그룹 한글명
                            example: 30세 이하
                          departmentNameEn:
                            type: string
                            description: 부서/연령/그룹 영문명
                            example: Under 30
                          divisionCategoryCode:
                            type: string
                            description: 디비전 카테고리 코드
                            example: INDIVIDUAL_MALE
                          divisionCategoryNameKo:
                            type: string
                            description: 디비전 카테고리 한글명
                            example: 남자개인
                          divisionCategoryNameEn:
                            type: string
                            description: 디비전 카테고리 영문명
                            example: Individual male
                          matchStyleType:
                            type: string
                            description: 매치 진행 방식
                            example: TOURNAMENT
                          phase:
                            type: string
                            description: 토너먼트 페이즈
                            example: R64

                      mainStatus:
                        type: string
                        nullable: false
                        description: FOP 메인 상태(경기 진행 핵심 상태)
                        example: DRAW_POOMSAE
                      sideStatus:
                        type: string
                        nullable: true
                        description: FOP 보조 상태(옵션 상태)
                        example: null

                      data:
                        type: object
                        description: 상태에 종속되는 상세 데이터(품새 선택/진행 정보)
                        required:
                          - firstPoomsaeType
                          - firstPoomsaeNameEn
                          - firstPoomsaeNameKo
                          - secondPoomsaeType
                          - secondPoomsaeNameEn
                          - secondPoomsaeNameKo
                          - currentPoomsaeSequenceType
                        properties:
                          firstPoomsaeType:
                            type: string
                            description: 1품새 타입 코드
                            example: TAEGEUK_7_JANG
                          firstPoomsaeNameEn:
                            type: string
                            description: 1품새 영문명
                            example: Taegeuk 7 Jang
                          firstPoomsaeNameKo:
                            type: string
                            description: 1품새 한글명
                            example: 태극 7장
                          secondPoomsaeType:
                            type: string
                            description: 2품새 타입 코드
                            example: TAEGEUK_8_JANG
                          secondPoomsaeNameEn:
                            type: string
                            description: 2품새 영문명
                            example: Taegeuk 8 Jang
                          secondPoomsaeNameKo:
                            type: string
                            description: 2품새 한글명
                            example: 태극 8장
                          currentPoomsaeSequenceType:
                            type: string
                            description: 현재 선택/진행 중인 품새 순번/포지션 식별자
                            example: P1

                      enableNextStatusTypes:
                        type: array
                        description: 현재 상태에서 전이 가능한 다음 상태 목록
                        items:
                          type: string
                        example:
                          - READY

              examples:
                defaultResponse:
                  value:
                    {
                      "success": true,
                      "data": {
                        "location": "fop",
                        "method": "change-status",
                        "data": {
                          "matchInfo": {
                            "competitionMatchPsSeq": 20024,
                            "matchNumber": 1001,
                            "divisionCode": "WT_RECOGNIZED_POOMSAE",
                            "divisionNameKo": "WT 공인품새룰",
                            "divisionNameEn": "WT Recognized Poomsae",
                            "departmentCode": "UNDER_30",
                            "departmentNameKo": "30세 이하",
                            "departmentNameEn": "Under 30",
                            "divisionCategoryCode": "INDIVIDUAL_MALE",
                            "divisionCategoryNameKo": "남자개인",
                            "divisionCategoryNameEn": "Individual male",
                            "matchStyleType": "TOURNAMENT",
                            "phase": "R64"
                          },
                          "mainStatus": "DRAW_POOMSAE",
                          "sideStatus": null,
                          "data": {
                            "firstPoomsaeType": "TAEGEUK_7_JANG",
                            "firstPoomsaeNameEn": "Taegeuk 7 Jang",
                            "firstPoomsaeNameKo": "태극 7장",
                            "secondPoomsaeType": "TAEGEUK_8_JANG",
                            "secondPoomsaeNameEn": "Taegeuk 8 Jang",
                            "secondPoomsaeNameKo": "태극 8장",
                            "currentPoomsaeSequenceType": "P1"
                          },
                          "enableNextStatusTypes": [
                            "READY"
                          ]
                        }
                      },
                      "error": null
                    }
                COMPETITION_MATCH_NOT_FOUND:
                  $ref: '../../openapi.yml/#/components/examples/COMPETITION_MATCH_NOT_FOUND'

        400:
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: '../../openapi.yml/#/components/responses/Error'
              examples:
                INVALID_TYPE_ERROR:
                  $ref: '../../openapi.yml#/components/examples/INVALID_TYPE_ERROR'

        403:
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '../../openapi.yml/#/components/responses/Error'
              examples:
                IS_NOT_AUTHORIZED:
                  $ref: '../../openapi.yml/#/components/examples/IS_NOT_AUTHORIZED'

  /competitions/{competitionSeq}/fop/match/result:
    patch:
      summary: 진행중 경기 결과 선택
      tags:
        - FOP
      parameters:
        - name: competitionSeq
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - competitionMatchPsSeq
                - resultDecision
              properties:
                competitionMatchPsSeq:
                  type: integer
                  description:
                    '매치 seq'
                  example: "1234"
                winnerMatchSideType:
                  type: string
                  enum:
                    - HOME
                    - AWAY
                  description:
                    '토너먼트 승자, 컷오프 일 땐 null'
                  example: "HOME"
                resultDecision:
                  type: string
                  enum:
                    - PTF
                    - RSC
                    - WDR
                    - DSQ
                    - PUN
                  description:
                    '경기 결과 코드'
                  example: "WDR"
      responses:
        '200':
          description: 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    nullable: true
                    example: null
                  error:
                    nullable: true
                    example: null
              examples:
                defaultResponse:
                  summary: Default Example
                  value:
                    {
                      "success": true,
                      "data": { },
                      "error": null
                    }
                COMPETITION_MATCH_NOT_FOUND:
                  $ref: '../../openapi.yml/#/components/examples/COMPETITION_MATCH_NOT_FOUND'
                END_OR_WAITING_MATCH_INVALID_FOR_OPERATION:
                  $ref: '../../openapi.yml/#/components/examples/END_OR_WAITING_MATCH_INVALID_FOR_OPERATION'
                MATCH_WINNER_NOT_FOUND:
                  $ref: '../../openapi.yml#/components/examples/MATCH_WINNER_NOT_FOUND'
                ONLY_TOURNAMENT_MATCH_CAN_UPDATE_RESULT:
                  $ref: '../../openapi.yml#/components/examples/ONLY_TOURNAMENT_MATCH_CAN_UPDATE_RESULT'
                IS_BYE_MATCH:
                  $ref: '../../openapi.yml#/components/examples/IS_BYE_MATCH'
                MATCH_RESULT_ALREADY_UP_TO_DATE:
                  $ref: '../../openapi.yml#/components/examples/MATCH_RESULT_ALREADY_UP_TO_DATE'

        400:
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: '../../openapi.yml/#/components/responses/Error'
              examples:
                INVALID_TYPE_ERROR:
                  $ref: '../../openapi.yml#/components/examples/INVALID_TYPE_ERROR'

        403:
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '../../openapi.yml/#/components/responses/Error'
              examples:
                IS_NOT_AUTHORIZED:
                  $ref: '../../openapi.yml/#/components/examples/IS_NOT_AUTHORIZED'

  /competitions/{competitionSeq}/fop/{competitionMatchPsSeq}/progress-seconds:
    get:
      summary: FOP 타이머 정보 가져오기
      tags:
        - FOP
      parameters:
        - name: competitionSeq
          in: path
          required: true
          schema:
            type: integer
        - name: competitionMatchPsSeq
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      competitionMatchPsSeq:
                        type: integer
                        description:
                          '매치 seq'
                        example: "1234"
                      progressSeconds:
                        type: integer
                        description:
                          '진행 시간 초단위'
                        example: "87"
                  error:
                    nullable: true
                    example: null
              examples:
                defaultResponse:
                  summary: Default Example
                  value:
                    {
                      "success": true,
                      "data": {
                        "competitionMatchPsSeq": 1234,
                        "progressSeconds": 87
                      },
                      "error": null
                    }

        403:
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '../../openapi.yml/#/components/responses/Error'
              examples:
                IS_NOT_AUTHORIZED:
                  $ref: '../../openapi.yml/#/components/examples/IS_NOT_AUTHORIZED'


  /competitions/{competitionSeq}/fop/{competitionMatchPsSeq}/timer:
    get:
      summary: 경기 진행 시간 가져오기
      tags:
        - FOP
      parameters:
        - name: competitionSeq
          in: path
          required: true
          schema:
            type: integer
        - name: competitionMatchPsSeq
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      competitionMatchPsSeq:
                        type: integer
                        description:
                          '매치 seq'
                        example: "1234"
                      progressSeconds:
                        type: integer
                        description:
                          'stop 할 때 lastSyncTimeMs 이용해서 계산 (초단위)'
                        example: 28
                      lastSyncTimeMillis:
                        type: integer
                        description:
                          ' start, sync 할 때 현재시각 저장, stop 시 null (milliseconds 단위)'
                        example: 1755058320128
                      accumulatedMillis:
                        type: integer
                        description:
                          'start~stop 사이에 heartbeat 시점의 시간들을 누적해서 더한 값 (milliseconds 단위)'
                        example: 52916
                      isRunning:
                        type: boolean
                        description:
                          '타이머 진행중인지'
                        example: true
                      version:
                        type: integer
                        description:
                          'timer 연산 version'
                        example: 43
                  error:
                    nullable: true
                    example: null
              examples:
                defaultResponse:
                  summary: Default Example
                  value:
                    {
                      "competitionMatchPsSeq": 10101,
                      "progressSeconds": 28,
                      "lastSyncTimeMillis": 1755058320128,
                      "accumulatedMillis": 52916,
                      "isRunning": true,
                      "version": 43
                    }

        403:
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '../../openapi.yml/#/components/responses/Error'
              examples:
                IS_NOT_AUTHORIZED:
                  $ref: '../../openapi.yml/#/components/examples/IS_NOT_AUTHORIZED'


  /competitions/{competitionSeq}/fop/timers:
    post:
      summary: 경기 진행 시간 여러개 가져오기
      tags:
        - FOP
      parameters:
        - name: competitionSeq
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - matchSeqList
              properties:
                matchSeqList:
                  type: array
                  description: '매치 seq 리스트'
                  items:
                    type: integer
                  example: [ 10015,20032 ]
      responses:
        '200':
          description: 성공
          content:
            application/json:
              schema:
                type: object
                required:
                  - success
                  - data
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      type: object
                      required:
                        - competitionMatchPsSeq
                        - progressSeconds
                        - accumulatedMillis
                        - isRunning
                        - version
                      properties:
                        competitionMatchPsSeq:
                          type: integer
                          description: '매치 seq'
                          example: 56331
                        progressSeconds:
                          type: integer
                          description: 'stop 할 때 lastSyncTimeMs 이용해서 계산 (초단위)'
                          example: 30721
                        lastSyncTimeMillis:
                          type: integer
                          nullable: true
                          description: 'start, sync 할 때 현재시각 저장, stop 시 null (milliseconds 단위)'
                          example: null
                        accumulatedMillis:
                          type: integer
                          description: 'start~stop 사이에 heartbeat 시점의 시간들을 누적해서 더한 값 (milliseconds 단위)'
                          example: 0
                        isRunning:
                          type: boolean
                          description: '타이머 진행중인지'
                          example: false
                        version:
                          type: integer
                          description: 'timer 연산 version'
                          example: 9
                  error:
                    nullable: true
                    example: null
              examples:
                defaultResponse:
                  summary: Default Example
                  value:
                    [
                      {
                        "competitionMatchPsSeq": 56331,
                        "progressSeconds": 30721,
                        "lastSyncTimeMillis": null,
                        "accumulatedMillis": 0,
                        "isRunning": false,
                        "version": 9
                      },
                      {
                        "competitionMatchPsSeq": 60818,
                        "progressSeconds": 24277,
                        "lastSyncTimeMillis": null,
                        "accumulatedMillis": 0,
                        "isRunning": false,
                        "version": 29
                      }
                    ]
        403:
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '../../openapi.yml/#/components/responses/Error'
              examples:
                IS_NOT_AUTHORIZED:
                  $ref: '../../openapi.yml/#/components/examples/IS_NOT_AUTHORIZED'